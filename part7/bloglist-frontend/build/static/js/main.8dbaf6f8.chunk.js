(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(26),l=n.n(c),o=n(10),u=n(64),s=n(33),i=n(113),m=n(115),f=n(108),d=n(15),g=n(24),p=(n(52),n(85),n(65)),E=n(5),b=n.n(E),v=n(6),h=n(20),O=n(112),L=n(116),y=n(21),S=n.n(y),w=null,N={getAll:function(){return S.a.get("/api/blogs").then(function(e){return e.data})},setToken:function(e){w="bearer ".concat(e)},addNewBlog:function(){var e=Object(v.a)(b.a.mark(function e(t){var n,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},console.log("from add blog service",t),e.next=4,S.a.post("/api/blogs",t,n);case 4:return a=e.sent,console.log("after respons",a.data),e.abrupt("return",a.data);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),addLike:function(){var e=Object(v.a)(b.a.mark(function e(t,n){var a,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:w}},console.log("from service",n),e.next=4,S.a.put("".concat("/api/blogs","/").concat(t),n,a);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),removeBlog:function(){var e=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.delete("".concat("/api/blogs","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.status);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return{loading:!0};case"GETBLOG_SUCCESS":return{items:t.blogs};case"ADD_BLOG":return e.concat(t.data.nblog);case"ADD_LIKE":case"ADD_COMMENT":return e.items.map(function(e){return e.id!==t.data.likedBlog.id?e:t.data.likedBlog});case"DEL_BLOG":return e.items.filter(function(e){return e.id!==t.data.id});case"GETALL_FAILURE":return{failure:!0};default:return e}},k=function(e){return{type:"ADD_NOTIFICATION",message:e}},j=function(e,t){return function(){var n=Object(v.a)(b.a.mark(function n(a){return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a(k(e)),setTimeout(function(){return a({type:"REMOVE_NOTIFICATION",message:""})},1e3*t);case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NOTIFICATION":return t.message;case"REMOVE_NOTIFICATION":return null;default:return e}},U=n(109),I=n(110),A=n(71),C=n(111),_=n(72),B=Object(g.i)(function(e){var t=e.blog,n=Object(a.useState)(!0),c=Object(h.a)(n,2),l=(c[0],c[1],Object(a.useState)()),o=Object(h.a)(l,2),u=(o[0],o[1],Object(g.g)()),s=(Object(g.h)().state||{from:{pathname:"/blogs"}}).from;return r.a.createElement(L.a,{style:{width:"50rem"}},r.a.createElement(L.a.Body,null,r.a.createElement(L.a.Title,null,t.title," "),r.a.createElement(L.a.Subtitle,{className:"mb-2 text-muted"},t.author),r.a.createElement(L.a.Text,null,t.title),r.a.createElement(L.a.Link,{href:t.url},t.url),r.a.createElement("br",null),r.a.createElement(f.a,{onClick:function(){u.push(s),e.handleLikeBtn(t.id)}},"Like"," "),"like ",r.a.createElement(U.a,{variant:"light"},t.likes),e.creatore&&r.a.createElement(f.a,{onClick:function(){u.push(s),e.handleRemoveBtn(t.id)}},"Remove"),r.a.createElement(I.a,{className:"list-group-flush"},t.comments.map(function(e){return r.a.createElement(A.a,{key:e.comments},e.comments)})),r.a.createElement(C.a,{inline:!0,onSubmit:function(n){n.preventDefault(),console.log(n.target.comment.value,t.id),e.addComment(t.id,n.target.comment.value)}},r.a.createElement(_.a,{type:"text",placeholder:"Enter Comment Here!",className:" sm-4",name:"comment"}),r.a.createElement("button",{className:"btn btn-default btn-lg btn-link",style:{"font-size":"36px"}},r.a.createElement("span",{className:"glyphicon glyphicon-comment"})),r.a.createElement("span",{className:"badge badge-notify"},"4"),r.a.createElement(f.a,{type:"submit"},"Submit"),r.a.createElement(C.a.Text,{className:"text-muted"},"You'll never get delete this"))))}),G={addLike:function(e){return function(){var t=Object(v.a)(b.a.mark(function t(n){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.addLike(e.id,e);case 2:a=t.sent,n({type:"ADD_LIKE",data:{likedBlog:a}});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},removeBlog:function(e){return function(){var t=Object(v.a)(b.a.mark(function t(n){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.removeBlog(e);case 2:t.sent,n({type:"DEL_BLOG",data:{id:e}});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:j,initializeBlogs:function(){return function(e){e({type:"INIT_BLOGS"}),N.getAll().then(function(t){return e(function(e){return{type:"GETBLOG_SUCCESS",blogs:e}}(t))},function(t){return e(function(e){return{type:"GETALL_FAILURE",error:e}}(t))})}},addComment:function(e,t){return console.log("from comment Dispatch",t),function(){var n=Object(v.a)(b.a.mark(function n(a){var r;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,N.addLike(e,{comments:t});case 2:r=n.sent,a({type:"ADD_COMMENT",data:{likedBlog:r}});case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},R=Object(g.i)(Object(o.b)(function(e,t){return{blogs:e.blogs,user:e.user}},G)(function(e){var t=Object(g.g)(),n=Object(g.h)(),c=Object(a.useState)("0"),l=Object(h.a)(c,2),o=l[0],u=l[1],s=(n.state||{from:{pathname:"/blogs"}}).from,i=e.blogs?e.blogs:{items:[]};Object(a.useEffect)(function(){null!==e.user&&(i.items||function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initializeBlogs();case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()())},[]);var m=function(){var t=Object(v.a)(b.a.mark(function t(n){var a,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.items.find(function(e){return e.id===n}),r=Object(p.a)({},a,{likes:a.likes+1}),t.next=4,e.addLike(r);case 4:e.setNotification("you liked ".concat(a.title),5),u(-1),e.initializeBlogs();case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=Object(v.a)(b.a.mark(function t(n){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.items.find(function(e){return e.id===n}),t.next=3,e.removeBlog(n);case 3:e.setNotification("you remove ".concat(a.title),5),e.initializeBlogs();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(v.a)(b.a.mark(function t(n,a){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.addComment(n,a);case 2:e.initializeBlogs();case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),y=function(t){var n=i.items.find(function(e){return e.id===t});return e.user.username===n.user[0].username};return r.a.createElement("div",null,e.blogs.loading&&r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),e.blogs.failur&&r.a.createElement("span",{className:"text-danger"},"ERROR: ",e.blogs.error),e.blogs.items&&r.a.createElement("div",null,r.a.createElement(O.a,{activeKey:o},e.blogs.items.map(function(e,n){return r.a.createElement(L.a,{key:e.id},r.a.createElement(O.a.Toggle,{as:L.a.Header,eventKey:n,onClick:function(){var e;(e=n)===o&&(e=-1,t.push(s)),u(e)}},r.a.createElement(d.b,{to:"/blogs/".concat(e.id)},e.title),r.a.createElement("span",{className:"badge badge-primary",style:{position:"absolute",right:"90px"}},e.likes)),r.a.createElement(O.a.Collapse,{eventKey:n},r.a.createElement(L.a.Body,null,r.a.createElement(g.b,{exact:!0,path:"/blogs/:id",render:function(e){var t,n=e.match;return r.a.createElement(B,{blog:(t=n.params.id,i.items.find(function(e){return e.id===t})),handleLikeBtn:m,handleRemoveBtn:f,addComment:E,creatore:y(n.params.id)})}}))))}))))})),D={login:function(){var e=Object(v.a)(b.a.mark(function e(t){var n,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("/api/login",t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},F={LOGIN_REQUEST:"USERS_LOGIN_REQUEST",LOGIN_SUCCESS:"USERS_LOGIN_SUCCESS",LOGIN_FAILURE:"USERS_LOGIN_FAILURE",LOGOUT:"USERS_LOGOUT",GETALL_REQUEST:"USERS_GETALL_REQUEST",GETALL_SUCCESS:"USERS_GETALL_SUCCESS",GETALL_FAILURE:"USERS_GETALL_FAILURE"},z=JSON.parse(localStorage.getItem("loggedUser")),K=z||null,H=function(e){return function(){var t=Object(v.a)(b.a.mark(function t(n){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.login(e);case 2:a=t.sent,n({type:F.LOGIN_SUCCESS,data:{loggedUser:a}});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F.LOGIN_REQUEST:return t.data.loggedUser&&window.localStorage.setItem("loggedUser",JSON.stringify(t.data.loggedUser)),t.data.loggedUser;case F.LOGIN_SUCCESS:return console.log("from login success",t.loggedUser),t.data.loggedUser&&window.localStorage.setItem("loggedUser",JSON.stringify(t.data.loggedUser)),t.data.loggedUser;case F.LOGIN_FAILURE:return{};case F.LOGOUT:return t.data;default:return e}},Q=r.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),c=Object(h.a)(n,2),l=c[0],o=c[1],u={display:l?"none":""},s={display:l?"":"none"},i=function(){o(!l)};return Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:i}}),r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement(f.a,{onClick:i},e.buttonLable)),r.a.createElement("div",{style:s,className:"togglableContent"},e.children," ",r.a.createElement(f.a,{onClick:i},"cancel")))}),M={logIn:H,setNotification:j},V=Object(o.b)(null,M)(function(e){var t=Object(g.g)(),n=(Object(g.h)().state||{from:{pathname:"/"}}).from,a=function(){var a=Object(v.a)(b.a.mark(function a(r){var c,l,o,u;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r.preventDefault(),a.prev=1,c=r.target.username.value,l=r.target.password.value,a.next=6,e.logIn({username:c,password:l});case 6:(o=window.localStorage.getItem("loggedUser"))&&(u=JSON.parse(o),N.setToken(u.token)),t.replace(n),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),e.setNotification("UserName or Password Wrong",10);case 14:case"end":return a.stop()}},a,null,[[1,11]])}));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement(Q,{buttonLable:"Log In"},r.a.createElement("h2",null,"Login"),r.a.createElement(C.a,{onSubmit:a},r.a.createElement(C.a.Group,null,r.a.createElement(C.a.Label,null,"username"),r.a.createElement(C.a.Control,{type:"text",name:"username"}),r.a.createElement(C.a.Label,null,"password"),r.a.createElement(C.a.Control,{className:"form-control",type:"password",name:"password"}),r.a.createElement(f.a,{type:"submit"},"login")))))}),Y=n(114),P=Object(o.b)(function(e){return{message:e.notification}})(function(e){return null===e.message?null:r.a.createElement("div",null,r.a.createElement(Y.a,{variant:"success"},e.message))}),W=function(){return S.a.get("/api/users").then(function(e){return e.data})},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F.GETALL_REQUEST:return{loading:!0};case F.GETALL_SUCCESS:return{items:t.users};case F.GETALL_FAILURE:return{error:t.error};default:return e}},X=function(e){Object(g.g)();var t=e.user;return r.a.createElement(L.a,null,r.a.createElement(L.a.Header,null," ",t.username," "),r.a.createElement(L.a.Subtitle,{className:"mb-4 text-muted"},r.a.createElement("strong",null,"Blogs of ",t.username)),r.a.createElement(I.a,{className:"list-group-flush"},t.blogs.map(function(e){return r.a.createElement(A.a,{key:e.id},e.title)})),r.a.createElement(L.a.Footer,null,"no. of blogs created:",t.blogs.length))},Z={getAll:function(){return function(e){e({type:F.GETALL_REQUEST}),W().then(function(t){return e(function(e){return{type:F.GETALL_SUCCESS,users:e}}(t))},function(t){return e(function(e){return{type:F.GETALL_FAILURE,error:e}}(t.toString()))})}}},$=Object(o.b)(function(e){return{user:e.user,users:e.users}},Z)(function(e){var t=e.user,n=e.users,c=Object(a.useState)("0"),l=Object(h.a)(c,2),o=l[0],u=l[1];Object(a.useEffect)(function(){null!==e.user&&function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAll();case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},[]);return r.a.createElement("div",{className:"col-bg-6 col-md-offset-3"},r.a.createElement("h1",null,"Hi ",t.name,"!"),r.a.createElement("p",null,"You're logged in with React!!"),r.a.createElement("h3",null,"All registered users:"),n.loading&&r.a.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading Users...")),n.error&&r.a.createElement("span",{className:"text-danger"},"ERROR: ",n.error),n.items&&r.a.createElement("div",null,r.a.createElement(O.a,{activeKey:o},n.items.map(function(e,t){return r.a.createElement(L.a,{key:e.id,eventKey:t,onClick:function(){var e;(e=t)===o&&(e=-1),u(e)}},r.a.createElement(O.a.Toggle,{as:L.a.Header},r.a.createElement(d.b,{to:"/users/".concat(e.id)},e.name," ")," ---------- Blogs:"," ",r.a.createElement(U.a,{varian:"light"},e.blogs.length)),r.a.createElement(O.a.Collapse,{eventKey:t},r.a.createElement(L.a.Body,null,r.a.createElement(g.b,{exact:!0,path:"/users/:id",render:function(e){var t,a=e.match;return r.a.createElement(X,{user:(t=a.params.id,n.items.find(function(e){return e.id===t}))})}}))))}))),r.a.createElement(d.b,{to:"/login"},"Logout"))}),ee={createBlog:function(e){return function(){var t=Object(v.a)(b.a.mark(function t(n){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.addNewBlog(e);case 2:a=t.sent,n({type:"ADD_BLOG",data:{nblog:a}});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:j},te=Object(o.b)(null,ee)(function(e){var t=function(){var t=Object(v.a)(b.a.mark(function t(n){var a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={title:n.target.title.value,author:n.target.author.value,url:n.target.url.value},console.log(a),t.prev=2,console.log(a),t.next=6,e.createBlog(a);case 6:e.setNotification("new blog ".concat(a.title," added"),10),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),e.setNotification("An Error has occured".concat(t.t0.message),10),console.log(t.t0.message);case 13:case"end":return t.stop()}},t,null,[[2,9]])}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(C.a,{onSubmit:t},r.a.createElement(C.a.Group,null,r.a.createElement(C.a.Label,null,"Title"),r.a.createElement(_.a,{type:"text",name:"title",placeholder:"Enter the Title"}),r.a.createElement(C.a.Label,null," Author"),r.a.createElement(_.a,{type:"text",name:"author",placeholder:"Enter The Author"}),r.a.createElement(C.a.Label,null,"URL"),r.a.createElement(_.a,{type:"text",name:"url",placeholder:"Enter url"})),r.a.createElement(f.a,{variant:"primary",type:"submit"},"Create"))}),ne=function(e){var t=e.user,n=e.logout,a=Object(g.g)();return null!==t?r.a.createElement("span",null,"!",t.name,r.a.createElement(f.a,{onClick:function(){n(),a.push("/")}},"Sign out")):r.a.createElement("div",null,r.a.createElement("p",null,"You are not logged in."))},ae=function(e){var t=e.user,n=e.children,a=Object(u.a)(e,["user","children"]);return r.a.createElement(g.b,Object.assign({},a,{render:function(e){var a=e.location;return null!==t?n:r.a.createElement(g.a,{to:{pathname:"/login",state:{from:a}}})}}))},re={setNotification:j,logIn:H,logOut:function(){return window.localStorage.clear("loggedUser"),{type:F.LOGOUT,data:null}}},ce=Object(o.b)(function(e){return{message:e.notification,user:e.user}},re)(function(e){var t=r.a.createRef();Object(a.useEffect)(function(){try{var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);N.setToken(t.token)}}catch(n){console.log(n.message)}},[]);return r.a.createElement(d.a,null,r.a.createElement("div",{className:"container",style:{height:"100%",margin:"0px 0px 0px 10px auto"}},r.a.createElement(P,{message:e.message}),r.a.createElement(i.a,Object(s.a)({collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light"},"expand","lg"),r.a.createElement(i.a.Brand,{href:"/"},"Blog List Application"),r.a.createElement(i.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(i.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(m.a,{className:"mr-auto"},r.a.createElement(d.b,{to:"/",style:{padding:30}},"Home Page"),r.a.createElement(d.b,{to:"/blogs",style:{padding:30}},"Blogs"),r.a.createElement(d.b,{to:"/users",style:{padding:30}},"Users"))),r.a.createElement(i.a.Toggle,null),r.a.createElement(i.a.Collapse,{className:"justify-content-end"},r.a.createElement(i.a.Text,null,"Signed in as: ",r.a.createElement(ne,{user:e.user,logout:function(){console.log("from logout");var t=e.user;window.localStorage.clear(),e.logOut(),e.setNotification("".concat(t.name," has logged Out")),setTimeout(function(){e.setNotification(null)},5e3)}})))),r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/",render:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Blog List Application"))}}),r.a.createElement(g.b,{exact:!0,path:"/login"},r.a.createElement(V,null)),r.a.createElement(ae,{user:e.user,path:"/blogs"},r.a.createElement(Q,{buttonLable:"Create Blog",ref:t},r.a.createElement(te,null)),r.a.createElement(R,null)),r.a.createElement(g.b,{path:"/blogs"}),r.a.createElement(ae,{user:e.user,path:"/"},r.a.createElement($,null)))))}),le=n(29),oe=n(74),ue=Object(le.c)({blogs:x,notification:T,user:J,users:q}),se=Object(le.d)(ue,Object(le.a)(oe.a));se.subscribe(function(){}),l.a.render(r.a.createElement(o.a,{store:se},r.a.createElement(ce,null)),document.getElementById("root"))},52:function(e,t,n){},75:function(e,t,n){e.exports=n(106)},85:function(e,t,n){}},[[75,1,2]]]);
//# sourceMappingURL=main.8dbaf6f8.chunk.js.map